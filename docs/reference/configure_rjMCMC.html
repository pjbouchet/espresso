<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Initial configuration — configure_rjMCMC • espresso</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Initial configuration — configure_rjMCMC" />
<meta property="og:description" content="Define several parameters required to configure the rjMCMC sampler." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">espresso</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.6.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/espresso.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Initial configuration</h1>
    
    <div class="hidden name"><code>configure_rjMCMC.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Define several parameters required to configure the rjMCMC sampler.</p>
    </div>

    <pre class="usage"><span class='fu'>configure_rjMCMC</span><span class='op'>(</span>
  <span class='va'>dat</span>,
  model.select <span class='op'>=</span> <span class='cn'>TRUE</span>,
  covariate.select <span class='op'>=</span> <span class='cn'>FALSE</span>,
  function.select <span class='op'>=</span> <span class='cn'>TRUE</span>,
  biphasic <span class='op'>=</span> <span class='cn'>FALSE</span>,
  proposal.mh <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>t.ij <span class='op'>=</span> <span class='fl'>10</span>, mu.i <span class='op'>=</span> <span class='fl'>5</span>, mu <span class='op'>=</span> <span class='fl'>2</span>, phi <span class='op'>=</span> <span class='fl'>5</span>, sigma <span class='op'>=</span> <span class='fl'>5</span>, nu <span class='op'>=</span> <span class='fl'>5</span>, tau <span class='op'>=</span> <span class='fl'>5</span>,
    alpha <span class='op'>=</span> <span class='fl'>2</span>, mu.ij <span class='op'>=</span> <span class='fl'>5</span>, psi <span class='op'>=</span> <span class='fl'>1</span>, omega <span class='op'>=</span> <span class='fl'>2</span>, psi.i <span class='op'>=</span> <span class='fl'>2</span>, k.ij <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>,
  proposal.rj <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>rj <span class='op'>=</span> <span class='fl'>5</span>, dd <span class='op'>=</span> <span class='fl'>10</span>, cov <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>,
  priors <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>covariates <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>30</span><span class='op'>)</span>, alpha <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>110</span>, <span class='fl'>160</span><span class='op'>)</span>, sigma <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>45</span><span class='op'>)</span>, phi <span class='op'>=</span>
    <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>45</span><span class='op'>)</span>, omega <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>5</span><span class='op'>)</span>, tau <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>45</span><span class='op'>)</span>, psi <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>,
  p.split <span class='op'>=</span> <span class='fl'>0.5</span>,
  p.merge <span class='op'>=</span> <span class='fl'>0.5</span>,
  bootstrap <span class='op'>=</span> <span class='cn'>TRUE</span>,
  n.rep <span class='op'>=</span> <span class='fl'>100</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dat</th>
      <td><p>Input BRS data. Must be an object of class <code>brsdata</code>.</p></td>
    </tr>
    <tr>
      <th>model.select</th>
      <td><p>Logical. If <code>TRUE</code>, between-model jumps will be allowed in the rjMCMC sampler. This argument can be set to <code>FALSE</code> to impose a species grouping and constrain parameter estimation accordingly.</p></td>
    </tr>
    <tr>
      <th>covariate.select</th>
      <td><p>Logical. Set to <code>TRUE</code> to allow contextual covariates to drop out of the model.</p></td>
    </tr>
    <tr>
      <th>function.select</th>
      <td><p>Logical. Set to <code>TRUE</code> to evaluate support for dose-response functional forms (monophasic vs. biphasic).</p></td>
    </tr>
    <tr>
      <th>biphasic</th>
      <td><p>Logical. Specifies which functional form to impose. Monophasic dose-response curves are returned when <code>biphasic = FALSE</code>. This argument is ignored when <code>function.select = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>proposal.mh</th>
      <td><p>Named list specifying the standard deviations of the proposal distributions used in the Metropolis-Hastings sampler.</p></td>
    </tr>
    <tr>
      <th>proposal.rj</th>
      <td><p>Named list specifying the standard deviations of the proposal distributions used in the reversible jump sampler. Must contain two elements: <code>mu</code> for response thresholds, and <code>cov</code> for covariates.</p></td>
    </tr>
    <tr>
      <th>priors</th>
      <td><p>Named list giving the means and standard deviations for Normal priors and the lower and upper bounds for Uniform priors. Relevant parameters for the monophasic model are as follows: <code>sigma</code> (Uniform), <code>phi</code> (Uniform). Parameters for the biphasic model include: <code>alpha</code> (Uniform), <code>omega</code> (Uniform), <code>tau</code> (Uniform), <code>psi</code> (Normal). Normal priors are placed on contextual <code>covariates</code>.</p></td>
    </tr>
    <tr>
      <th>p.split</th>
      <td><p>Probability of choosing to split a group of species when initiating a split-merge move. This parameter is constrained to be <code>1</code> when all species are in a single group. <code>p.split</code> and <code>p.merge</code> must sum to <code>1</code>.</p></td>
    </tr>
    <tr>
      <th>p.merge</th>
      <td><p>Probability of choosing to merge two groups of species when initiating a split-merge move. This parameter is constrained to be <code>1</code> when all species are in their own groups. <code>p.split</code> and <code>p.merge</code> must sum to <code>1</code>.</p></td>
    </tr>
    <tr>
      <th>bootstrap</th>
      <td><p>Logical, defaults to TRUE. Whether to perform bootstrap clustering. As this step can be time-consuming, setting this argument to <code>FALSE</code> increases efficiency when re-configuring the sampler.</p></td>
    </tr>
    <tr>
      <th>n.rep</th>
      <td><p>Number of replicate bootstrap datasets used for clustering (see <code>Details</code>).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list object of class <code>rjconfig</code> identical to the input <code>brsdata</code> object, with an additional <code>config</code> element composed of:</p>
<table class='table'>
<tr><td><code>var</code></td><td>Empirical estimates of φ and σ</td></tr>
<tr><td><code>prop</code></td><td>Standard deviations of MCMC proposal distributions</td></tr>
<tr><td><code>clust</code></td><td>Outputs from the cluster analysis</td></tr>
<tr><td><code>boot</code></td><td>Species group assignments for each bootstrap dataset</td></tr>
<tr><td><code>mlist</code></td><td>Unique species group assignments</td></tr>
<tr><td><code>prior</code></td><td>Mean and standard deviation of the Normal priors placed on covariates</td></tr>
<tr><td><code>...</code></td><td>Other elements pulled from the <code>brsdata</code> object</td></tr>
</table>


    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function performs three actions:</p><dl>
<dt>Variance</dt><dd><p>Returns empirical estimates of between-whale (φ) and within-whale between-exposure (σ) variation, which are needed to generate starting values for the MCMC chains</p></dd>
<dt>Proposals</dt><dd><p>Defines the means and standard deviations of relevant proposal distributions and priors</p></dd>
<dt>Clustering</dt><dd><p>Performs a cluster analysis using <code>n.rep</code> bootstrap replicates of the input data, in order to initialise between-model jumps. The analysis is run using <code><a href='https://mclust-org.github.io/mclust/reference/Mclust.html'>Mclust</a></code> (Scrucca et al. 2016)
 on both (1) species means and (2) raw observations. These respectively provide estimates of the probability distributions of (1) unique groupings, and (2) numbers of groups, where the latter ranges from <code>n = 1</code> when all species belong to the same group, to <code>n = n.species</code> when each species is treated individually.</p></dd>

</dl>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Scrucca L, Fop M, Murphy TB, Raftery AE (2016).
&#8220;mclust 5: Clustering, classification and density estimation using Gaussian finite mixture models.&#8221;
<em>The R Journal</em>, <b>8</b>(1), 289--317.
<a href='https://doi.org/10.32614/RJ-2016-021'>https://doi.org/10.32614/RJ-2016-021</a>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='run_rjMCMC.html'>run_rjMCMC</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Phil J. Bouchet</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>espresso</span><span class='op'>)</span>

<span class='co'># Import the example data, excluding species </span>
<span class='co'># with less than 5 observations</span>
<span class='va'>mydat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='read_data.html'>read_data</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='cn'>NULL</span>, min.N <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span> 
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>mydat</span><span class='op'>)</span>

<span class='co'># Configure the rjMCMC sampler</span>
<span class='va'>mydat.config</span> <span class='op'>&lt;-</span> <span class='fu'>configure_rjMCMC</span><span class='op'>(</span>dat <span class='op'>=</span> <span class='va'>mydat</span>,
                                 model.select <span class='op'>=</span> <span class='cn'>TRUE</span>,
                                 covariate.select <span class='op'>=</span> <span class='cn'>FALSE</span>,
                                 function.select <span class='op'>=</span> <span class='cn'>FALSE</span>,
                                 n.rep <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>mydat.config</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Phil Bouchet, Len Thomas, Catriona Harris, Elizabeth Henderson, Dina Sadykova.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


